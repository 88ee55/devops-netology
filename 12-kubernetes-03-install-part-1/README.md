# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"
Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

## Задание 1: Описать требования к кластеру
Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* база данных должна быть отказоустойчивой (не менее трех копий, master-slave) и потребляет около 4 ГБ ОЗУ в работе;
* кэш должен быть аналогично отказоустойчивый, более трех копий, потребление: 4 ГБ ОЗУ, 1 ядро;
* фронтенд обрабатывает внешние запросы быстро, отдавая статику: не более 50 МБ ОЗУ на каждый экземпляр;
* бекенду требуется больше: порядка 600 МБ ОЗУ и по 1 ядру на копию.

Требования: опишите, сколько нод в кластере и сколько ресурсов (ядра, ОЗУ, диск) нужно для запуска приложения. Расчет вести из необходимости запуска 5 копий фронтенда и 10 копий бекенда, база и кеш.

Минимальное колличество требуемых ресурсов:
|  | Количество, шт |  RAM, Мб | CPU, шт | $\Sigma$ RAM, Мб | $\Sigma$ CPU, шт |
|-------------|:--:|:----:|:---:|:-----:|:---:|
| Master node | 1  | 2048 | 1,5 | 2048  | 1,5 |
| Worker node | 4  | 700  | 0,5 | 2800  | 2   |
| DB          | 3  | 4096 | 1   | 12288 | 3   |
| Cache       | 4  | 4096 | 1   | 16384 | 4   |
| Frontend    | 5  | 50   | 0,1 | 250   | 0,5 |
| Backend     | 10 | 600  | 1   | 6000  | 10  |
| Итого       |    |      |     | 39770 | 21  |

Отдельная нода для master ноды, 4 worker ноды.

Чтобы на каждой ноде был инстанс базы данных + запасная нода для бд в случае падения одной ноды.

В этом случае минимальная характеристика worker ноды
|  | Количество, шт |  RAM, Мб | CPU, шт | $\Sigma$ RAM, Мб | $\Sigma$ CPU, шт |
|-------------|:--:|:----:|:---:|:-----:|:---:|
| Worker node | 1  | 700  | 0,5 | 700   | 1   |
| DB          | 1  | 4096 | 1   | 4096  | 1   |
| Cache       | 1  | 4096 | 1   | 4096  | 1   |
| Frontend    | 2  | 50   | 0,1 | 100   | 0,2 |
| Backend     | 3  | 600  | 1   | 1800  | 3   |
| Итого       |    |      |     | 10792 | 5,2 |

Округлим, 12Gb RAM и 6 CPU

Но при таком распределении, 1 нода будет почти всегда свободна, и остальные 3 маскимально нагружены. Поэтому нагрузку лучше равномерно распределить на все 4 ноды.

Ну и не зыбаваем про master ноду. 2Gb RAM и 2 CPU

Итого:

(12Gb RAM + 6 CPU) x 4

(2Gb RAM + 2 CPU) x 1

Один из подходов распределения ресурсов https://habr.com/ru/company/nixys/blog/573316/

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---